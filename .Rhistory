b1[j,] <- c(a2[j],a2_1$hpnicuyn)
total_beds[i,2]<-total_beds[i,2]+if(!is.null(a2_1$hpicuyn)){as.numeric(levels(a2_1$hpicuyn))} else {0}
}
View(b1)
b1[j,] <- c(a2[j],a2_1$hpnicuyn)
b1 <- rbind(c(a2[j],a2_1$hpnicuyn))
b1 <- data.frame()
for (j in 1:length(a2)) {
url2 <- paste0(
service_url2,
paste0(
"?HPID=", a2[j],
"&pageNo=1&numOfRows=1000"
),
paste0("&ServiceKey=", key)
)
res2_1 <- xpathApply(xmlRoot(xmlParse(url2)), xpath_result)
a2_1 <- xmlToDataFrame(res2_1)
b1 <- rbind(c(a2[j],a2_1$hpnicuyn))
total_beds[i,2]<-total_beds[i,2]+if(!is.null(a2_1$hpicuyn)){as.numeric(levels(a2_1$hpicuyn))} else {0}
}
rbind(c(a2[j],a2_1$hpnicuyn))
b1 <- data.frame()
for (j in 1:length(a2)) {
url2 <- paste0(
service_url2,
paste0(
"?HPID=", a2[j],
"&pageNo=1&numOfRows=1000"
),
paste0("&ServiceKey=", key)
)
res2_1 <- xpathApply(xmlRoot(xmlParse(url2)), xpath_result)
a2_1 <- xmlToDataFrame(res2_1)
b1 <- rbind(b1,c(a2[j],a2_1$hpnicuyn))
total_beds[i,2]<-total_beds[i,2]+if(!is.null(a2_1$hpicuyn)){as.numeric(levels(a2_1$hpicuyn))} else {0}
}
View(b1)
b1 <- data.frame()
b1
b1 <- data.frame()
for (j in 1:length(a2)) {
url2 <- paste0(
service_url2,
paste0(
"?HPID=", a2[j],
"&pageNo=1&numOfRows=1000"
),
paste0("&ServiceKey=", key)
)
res2_1 <- xpathApply(xmlRoot(xmlParse(url2)), xpath_result)
a2_1 <- xmlToDataFrame(res2_1)
b1 <- rbind(b1,c(a2[j],if(!is.null(a2_1$hpicuyn)){as.numeric(levels(a2_1$hpicuyn))} else {NA}))
total_beds[i,2]<-total_beds[i,2]+if(!is.null(a2_1$hpicuyn)){as.numeric(levels(a2_1$hpicuyn))} else {0}
}
View(b1)
1:length(a2)
a2
View(a2_1)
a2_1$hpnicuyn
a2_1$hpicuyn
b1,c(a2[j],if(!is.null(a2_1$hpicuyn)){as.numeric(levels(a2_1$hpicuyn))} else {NA})
c(a2[j],if(!is.null(a2_1$hpicuyn)){as.numeric(levels(a2_1$hpicuyn))} else {NA})
str(c(a2[j],if(!is.null(a2_1$hpicuyn)){as.numeric(levels(a2_1$hpicuyn))} else {NA}))
rbind(b1,c(a2[j],if(!is.null(a2_1$hpicuyn)){as.numeric(levels(a2_1$hpicuyn))} else {NA}))
b1 <- data.frame()
b1 <- data.frame(x="A123",
value=0)
str(b1)
b1 <- data.frame(x=character("A123"),
value=0)
str(b1)
b1 <- data.frame(x=as.character("A123"),
value=0)
b1
str(b1)
for (j in 1:length(a2)) {
url2 <- paste0(
service_url2,
paste0(
"?HPID=", a2[j],
"&pageNo=1&numOfRows=1000"
),
paste0("&ServiceKey=", key)
)
res2_1 <- xpathApply(xmlRoot(xmlParse(url2)), xpath_result)
a2_1 <- xmlToDataFrame(res2_1)
b1 <- rbind(b1,c(a2[j],if(!is.null(a2_1$hpicuyn)){as.numeric(levels(a2_1$hpicuyn))} else {NA}))
total_beds[i,2]<-total_beds[i,2]+if(!is.null(a2_1$hpicuyn)){as.numeric(levels(a2_1$hpicuyn))} else {0}
}
View(b1)
warnings()
b1 <- data.frame(x="ASD",
value=0)
str(b1)
b1 <- data.frame(x=c("asd","sda"),
value=0)
str(b1)
b1 <- data.frame(x=as.character("asd"),
value=0)
str(b1)
b1 <- data.frame(x="asd",
value=0,
stringsAsFactors = F)
str(b1)
for (j in 1:length(a2)) {
url2 <- paste0(
service_url2,
paste0(
"?HPID=", a2[j],
"&pageNo=1&numOfRows=1000"
),
paste0("&ServiceKey=", key)
)
res2_1 <- xpathApply(xmlRoot(xmlParse(url2)), xpath_result)
a2_1 <- xmlToDataFrame(res2_1)
b1 <- rbind(b1,c(a2[j],if(!is.null(a2_1$hpicuyn)){as.numeric(levels(a2_1$hpicuyn))} else {NA}))
total_beds[i,2]<-total_beds[i,2]+if(!is.null(a2_1$hpicuyn)){as.numeric(levels(a2_1$hpicuyn))} else {0}
}
View(b1)
b1 <- data.frame(
stringsAsFactors = F)
for (j in 1:length(a2)) {
url2 <- paste0(
service_url2,
paste0(
"?HPID=", a2[j],
"&pageNo=1&numOfRows=1000"
),
paste0("&ServiceKey=", key)
)
res2_1 <- xpathApply(xmlRoot(xmlParse(url2)), xpath_result)
a2_1 <- xmlToDataFrame(res2_1)
b1 <- rbind(b1,c(a2[j],if(!is.null(a2_1$hpicuyn)){as.numeric(levels(a2_1$hpicuyn))} else {NA}))
total_beds[i,2]<-total_beds[i,2]+if(!is.null(a2_1$hpicuyn)){as.numeric(levels(a2_1$hpicuyn))} else {0}
}
library(XML)
library(dplyr)
for (j in 1:length(a2)) {
url2 <- paste0(
service_url2,
paste0(
"?HPID=", a2[j],
"&pageNo=1&numOfRows=1000"
),
paste0("&ServiceKey=", key)
)
res2_1 <- xpathApply(xmlRoot(xmlParse(url2)), xpath_result)
a2_1 <- xmlToDataFrame(res2_1)
b1 <- rbind(b1,c(a2[j],if(!is.null(a2_1$hpicuyn)){as.numeric(levels(a2_1$hpicuyn))} else {NA}))
total_beds[i,2]<-total_beds[i,2]+if(!is.null(a2_1$hpicuyn)){as.numeric(levels(a2_1$hpicuyn))} else {0}
}
View(b1)
b1 <- data.frame(x="asd",
value=0,
stringsAsFactors = F)
for (j in 1:length(a2)) {
url2 <- paste0(
service_url2,
paste0(
"?HPID=", a2[j],
"&pageNo=1&numOfRows=1000"
),
paste0("&ServiceKey=", key)
)
res2_1 <- xpathApply(xmlRoot(xmlParse(url2)), xpath_result)
a2_1 <- xmlToDataFrame(res2_1)
b1 <- rbind(b1,c(a2[j],if(!is.null(a2_1$hpicuyn)){as.numeric(levels(a2_1$hpicuyn))} else {NA}))
total_beds[i,2]<-total_beds[i,2]+if(!is.null(a2_1$hpicuyn)){as.numeric(levels(a2_1$hpicuyn))} else {0}
}
View(b1)
View(a1)
total_beds <- readRDS("~/yd_10/total_beds.rds")
View(total_beds)
library(dplyr)
icu_data<-readRDS("icu_data.rds") %>%
`[`(nrow(.),)
total_beds <- sum(as.numeric(icu_data[,3:length(icu_data)]))
colnames(icu_data)[3:19] <- c("서울","부산","대구","인천",
"광주","대전","울산","세종",
"경기","강원","충북","충남","전북",
"전남","경북","경남","제주")
View(icu_data)
icu_data<-readRDS("icu_data.rds") %>%
`[`(nrow(.),)
View(icu_data)
library(rreshape2)
library(reshape2)
icu_data<-readRDS("icu_data.rds") %>%
`[`(nrow(.),) %>%
melt()
View(icu_data)
icu_data<-readRDS("icu_data.rds") %>%
`[`(nrow(.),) %>%
melt(.)
View(icu_data)
icu_data<-readRDS("icu_data.rds") %>%
`[`(nrow(.),) %>%
cast()
library(reshape2)
icu_data<-readRDS("icu_data.rds") %>%
`[`(nrow(.),) %>%
acast()
icu_data<-readRDS("icu_data.rds") %>%
`[`(nrow(.),)
b1 <- melt(icu_data)
b1 <- melt(icu_data,id.vars = "date")
View(b1)
icu_data<-readRDS("icu_data.rds") %>%
`[`(nrow(.),)%>%
melt(.,id.vars="date")
rm(b1)
View(icu_data)
beds_lim <- readRDS("calc_total_beds.r")
beds_lim <- readRDS("total_beds.rds")
View(beds_lim)
icu_data<-readRDS("icu_data.rds") %>%
`[`(nrow(.),)%>%
`colnames<-`(c("date","time","서울","부산","대구","인천",
"광주","대전","울산","세종",
"경기","강원","충북","충남","전북",
"전남","경북","경남","제주"))
View(icu_data)
icu_data<-readRDS("icu_data.rds") %>%
`[`(nrow(.),)%>%
`colnames<-`(c("date","time","서울","부산","대구","인천",
"광주","대전","울산","세종",
"경기","강원","충북","충남","전북",
"전남","경북","경남","제주")) %>%
melt(.,id.vars="date")
View(icu_data)
styler:::style_active_file()
View(icu_data)
View(icu_data)
### --- 1.1 icudata.RDS ---
icu_data <- readRDS("icu_data.rds") %>%
`[`(nrow(.), ) %>%
`colnames<-`(
c("date", "time", "서울", "부산", "대구", "인천",
"광주", "대전", "울산", "세종",
"경기", "강원", "충북", "충남", "전북",
"전남", "경북", "경남", "제주"
)
) %>%
t()
View(icu_data)
### --- 1.1 icudata.RDS ---
icu_data <- readRDS("icu_data.rds") %>%
`[`(nrow(.), ) %>%
`colnames<-`(
c("date", "time", "서울", "부산", "대구", "인천",
"광주", "대전", "울산", "세종",
"경기", "강원", "충북", "충남", "전북",
"전남", "경북", "경남", "제주"
)
)
View(icu_data)
### --- 1.1 icudata.RDS ---
icu_data <- readRDS("icu_data.rds") %>%
`[`(nrow(.), ) %>%
`colnames<-`(
c("date", "time", "서울", "부산", "대구", "인천",
"광주", "대전", "울산", "세종",
"경기", "강원", "충북", "충남", "전북",
"전남", "경북", "경남", "제주"
)
) %>%
melt()
### --- 1.1 icudata.RDS ---
icu_data <- readRDS("icu_data.rds") %>%
`[`(nrow(.), ) %>%
`colnames<-`(
c("date", "time", "서울", "부산", "대구", "인천",
"광주", "대전", "울산", "세종",
"경기", "강원", "충북", "충남", "전북",
"전남", "경북", "경남", "제주"
)
) %>%
melt(id.vars=colnames(icu_data))
View(icu_data)
### --- 1.1 icudata.RDS ---
icu_data <- readRDS("icu_data.rds") %>%
`[`(nrow(.), ) %>%
`colnames<-`(
c("date", "time", "서울", "부산", "대구", "인천",
"광주", "대전", "울산", "세종",
"경기", "강원", "충북", "충남", "전북",
"전남", "경북", "경남", "제주"
)
) %>%
melt(id.vars = "date")
View(icu_data)
### --- 1.1 icudata.RDS ---
icu_data <- readRDS("icu_data.rds") %>%
`[`(nrow(.), ) %>%
`colnames<-`(
c("date", "time", "서울", "부산", "대구", "인천",
"광주", "대전", "울산", "세종",
"경기", "강원", "충북", "충남", "전북",
"전남", "경북", "경남", "제주"
)
) %>%
melt(id.vars = "date") %>%
`[`(,-1)
View(icu_data)
### --- 1.1 icudata.RDS ---
icu_data <- readRDS("icu_data.rds") %>%
`[`(nrow(.), ) %>%
`colnames<-`(
c("date", "time", "서울", "부산", "대구", "인천",
"광주", "대전", "울산", "세종",
"경기", "강원", "충북", "충남", "전북",
"전남", "경북", "경남", "제주"
)
) %>%
melt(id.vars = "date") %>%
`[`(-1,-1)
View(icu_data)
icu_global <- merge(icu_data,beds_lim)
View(beds_lim)
icu_global <- merge(icu_data,beds_lim,by.x = variable,by.y=geo)
icu_global <- merge(icu_data,beds_lim,by.x = "variable",by.y="geo")
View(icu_global)
### --- 1.1 icudata.RDS ---
icu_data <- readRDS("icu_data.rds") %>%
`[`(nrow(.), ) %>%
`colnames<-`(
c("date", "time", "서울", "부산", "대구", "인천",
"광주", "대전", "울산", "세종",
"경기", "강원", "충북", "충남", "전북",
"전남", "경북", "경남", "제주"
)
) %>%
melt(id.vars = "date") %>%
`[`(-1,-1) %>%
`rownames<-`(1:17)
icu_global <- merge(icu_data,beds_lim,by.x = "variable",by.y="geo")
icu_global <- merge(icu_data,beds_lim,by.x = "variable",by.y=geo)
icu_global <- merge(icu_data,beds_lim)
icu_global <- merge(icu_data,beds_lim,by.x = "variable",by.y="geo",all = T)
View(icu_global)
View(beds_lim)
beds_lim <- readRDS("total_beds.rds") %>%
`colnames<-`(
c("date", "time", "서울", "부산", "대구", "인천",
"광주", "대전", "울산", "세종",
"경기", "강원", "충북", "충남", "전북",
"전남", "경북", "경남", "제주"
)
)
icu_global <- merge(icu_data,beds_lim,by.x = "variable",by.y="geo")
beds_lim <- readRDS("total_beds.rds") %>%
`colnames<-`(
c("서울", "부산", "대구", "인천",
"광주", "대전", "울산", "세종",
"경기", "강원", "충북", "충남", "전북",
"전남", "경북", "경남", "제주"
)
)
icu_global <- merge(icu_data,beds_lim,by.x = "variable",by.y="geo")
beds_lim$geo <-
c("서울", "부산", "대구", "인천",
"광주", "대전", "울산", "세종",
"경기", "강원", "충북", "충남", "전북",
"전남", "경북", "경남", "제주"
)
saveRDS(beds_lim,"total_beds.rds")
View(beds_lim)
beds_lim <- readRDS("total_beds.rds")
icu_global <- merge(icu_data,beds_lim,by.x = "variable",by.y="geo")
View(icu_global)
icu_global <- merge(icu_data,beds_lim,by.x = "variable",by.y="geo") %>%
`colnames<-`(c("geo","beds","limit"))
View(icu_global)
styler:::style_active_file()
### --- 1.1 icudata.RDS ---
icu_data <- readRDS("icu_data.rds") %>%
`[`(nrow(.), ) %>%
`colnames<-`(
c(
"date", "time", "서울", "부산", "대구", "인천",
"광주", "대전", "울산", "세종",
"경기", "강원", "충북", "충남", "전북",
"전남", "경북", "경남", "제주"
)
) %>%
melt(id.vars = "date") %>%
`[`(-1, -1)
beds_lim <- readRDS("total_beds.rds")
icu_global <- merge(icu_data, beds_lim, by.x = "variable", by.y = "geo") %>%
`colnames<-`(c("geo", "beds", "limit"))
View(icu_global)
View(icu_global)
shiny::runApp('~/yd_10/shiny_app')
str(icu_global)
icu_global$beds <- as.numeric(icu_global$beds)
colSums(icu_global)
colSums(icu_global$beds)
apply(icu_global[,2:3], 2, sum)
icu_global <- rbind(c("total",apply(icu_global[,2:3], 2, sum)))
icu_global <- merge(icu_data, beds_lim, by.x = "variable", by.y = "geo") %>%
`colnames<-`(c("geo", "beds", "limit"))
icu_global$beds <- as.numeric(icu_global$beds)
icu_global <- rbind(icu_global,c("total",apply(icu_global[,2:3], 2, sum)))
View(icu_global)
c("total",apply(icu_global[,2:3], 2, sum))
c("total",apply(icu_global[,2:3], 2, sum))
c("total",apply(icu_global[,2:3], 2, sum))
apply(icu_global[,2:3], 2, sum)
apply(icu_global[,2:3], 2, sum)
apply(icu_global[,2:3], 2, sum)
str(icu_global)
icu_global <- merge(icu_data, beds_lim, by.x = "variable", by.y = "geo") %>%
`colnames<-`(c("geo", "beds", "limit"))
str(icu_global)
icu_global$beds <- as.numeric(icu_global$beds)
apply(icu_global[,2:3], 2, sum)
str(apply(icu_global[,2:3], 2, sum))
apply(icu_global[,2:3], 2, sum)[1:2]
apply(icu_global[,2:3], 2, sum)[[1:2]]
apply(icu_global[,2:3], 2, sum)[[1]]
apply(icu_global[,2:3], 2, sum)[[2]]
apply(icu_global[,2:3], 2, sum)[[3]]
apply(icu_global[,2:3], 2, sum)[[1,2]]
apply(icu_global[,2:3], 2, sum)[[1:2]]
apply(icu_global[,2:3], 2, sum)[1:2]
tot <- apply(icu_global[,2:3], 2, sum)
icu_global <- rbind(icu_global,c("total",tot[[1]],tot[[2]]))
c("total",tot[[1]],tot[[2]])
str(c("total",tot[[1]],tot[[2]]))
tot <- apply(icu_global[,2:3], 2, sum) %>%
as.numeric()
str(tot)
icu_global$beds <- as.numeric(icu_global$beds)
colSums(icu_global[,2:3])
icu_global$beds <- as.numeric(icu_global$beds)
str(icu_global)
icu_global <- merge(icu_data, beds_lim, by.x = "variable", by.y = "geo") %>%
`colnames<-`(c("geo", "beds", "limit"))
str(icu_global)
icu_global$beds <- as.numeric(icu_global$beds)
colSums(icu_global[,2:3])
icu_global <- rbind(colSums(icu_global[,2:3]))
icu_global <- merge(icu_data, beds_lim, by.x = "variable", by.y = "geo") %>%
`colnames<-`(c("geo", "beds", "limit"))
icu_global$beds <- as.numeric(icu_global$beds)
icu_global <- rbind(icu_global,colSums(icu_global[,2:3]))
icu_global <- merge(icu_data, beds_lim, by.x = "variable", by.y = "geo") %>%
`colnames<-`(c("geo", "beds", "limit"))
icu_global$beds <- as.numeric(icu_global$beds)
str(icu_global)
icu_global <- merge(icu_data, beds_lim, by.x = "variable", by.y = "geo") %>%
`colnames<-`(c("geo", "beds", "limit"))
icu_global$beds <- as.numeric(icu_global$beds)
icu_global[18,]
icu_global[18,] <- c("total",sum(icu_global$beds),sum(icu_global$limit))
str(icu_global)
View(icu_global)
tot <- apply(icu_global[2:3], 2, sum)
str(icu_global)
icu_global <- merge(icu_data, beds_lim, by.x = "variable", by.y = "geo") %>%
`colnames<-`(c("geo", "beds", "limit"))
icu_global$beds <- as.numeric(icu_global$beds)
str(icu_global)
tot <- apply(icu_global[2:3], 2, sum)
tot
str(tot)
tot[1]
global_total <- c(tot[[1]],tot[[2]]-tot[[1]])
runApp('~/yd_10/shiny_app')
runApp('~/yd_10/shiny_app')
runApp('~/yd_10/shiny_app')
runApp('~/yd_10/shiny_app')
icu_global
a=1
icu_global$geo[a]
runApp('~/yd_10/shiny_app')
runApp('~/yd_10/shiny_app')
runApp('~/yd_10/shiny_app')
runApp('~/yd_10/shiny_app')
runApp('~/yd_10/shiny_app')
runApp('~/yd_10/shiny_app')
levels(icu_global$geo[a])
labels(icu_global$geo[a])
levels(icu_global$geo)[a]
runApp('~/yd_10/shiny_app')
global_total <- c(tot[[1]],tot[[2]]-tot[[1]]) %>%
data.frame()
View(global_total)
global_total <- c(tot[[1]],tot[[2]]-tot[[1]]) %>%
data.frame() %>%
t()
View(global_total)
runApp('~/yd_10/shiny_app')
global_total <- c(tot[[1]],tot[[2]]-tot[[1]])
global_total <- c(tot[[1]],tot[[2]]-tot[[1]]) %>%
as.data.frame()
View(global_total)
global_total <- c(tot[[1]],tot[[2]]-tot[[1]]) %>%
as.data.frame() %>%
t()
str(global_total)
global_total <- c(tot[[1]],tot[[2]]-tot[[1]])
tot <- apply(icu_global[2:3], 2, sum)
global_total <- data.frame(n1 = tot[1],
n2 = tot[2])
View(global_total)
global_total <- data.frame(n1 = tot[1],
n2 = tot[2]) %>%
`rownames<-`(1)
runApp('~/yd_10/shiny_app')
runApp('~/yd_10/shiny_app')
