---
title: "3주차 실습2-2"
author: "Jiwon kim"
date: '`r Sys.Date()`'
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


##1. ** 일원배치 분산분석 (One-way ANOVA) **
* 하나의 요인에 대한 3개 이상 집단의 모평균 차이 검정(1개의 독립변수, 1개의 종속변수)
* 그룹 간 변동(between-group variation)과 그룹 내 변동(within-group variation)을 이용해 분석
* 검정 : 정규성 검정, 등분산성 검정

    1-1) 데이터 불러오기
     - 면역이상에 대한 한 연구에서 자폐아, 정상아, 지진아에 대한 혈청 항원의 농도 
```{r}
setwd("/state/partition1/home/ex_data/")
dat <- read.delim("Anova.txt", header = TRUE)

dat
str(dat)

dat$group <- as.factor(dat$group)

```
    
    1-2) 오차의 정규성 검정
$$ 
\left\{
    \begin{array}{l}
      H_0 : 각 그룹의 변수는 정규분포를 따른다.\\
      H_1 : 각 그룹의 변수는 정규분포를 따르지 않는다. 
    \end{array}
  \right.
$$
```{r}
tapply(dat$value , dat$group, shapiro.test)

qqnorm(dat$value)
qqline(dat$value, col="red")

```

    1-3) 등분산성 검정 
$$ 
\left\{
    \begin{array}{l}
      H_0 : 모든 그룹의 모집단의 분산이 동일하다. \\
      H_1 : 모든 그룹의 모집단의 분산이 동일하지 않다.
    \end{array}
  \right.
$$

```{r}
library(lawstat)
bartlett.test(value ~ group, data = dat)

```
    
    1-4) 모수적 검정 (정규성 만족): One-way ANOVA 
$$ 
\left\{
    \begin{array}{l}
      H_0 : 그룹에 따른 각 집단의 혈청 항원의 농도의 차이가 없다.\\
      H_1 : not H_0. 
    \end{array}
  \right.
$$
```{r}
fit <- aov(dat$value ~ dat$group)
summary(fit)

#다중비교 : 한 번에 한 쌍의 모평균이 다른지 검정
TukeyHSD(fit)
plot(TukeyHSD(fit))

```

  1-5) 비모수적 검정 (정규성 불만족) : Kruskal – Wallis test
$$ 
\left\{
    \begin{array}{l}
      H_0 : 그룹에 따른 각 집단의 혈청 항원의 농도의 차이가 없다. \\
      H_1 : not H_0
    \end{array}
  \right.
$$
```{r}
setwd("/state/partition1/home/ex_data/")
dat2 <- read.delim("kruskal_test.txt", header = TRUE)
dat2$group <- as.factor(dat2$group)

kruskal.test(value ~ group, data = dat2)

```


##2. ** 이원배치 분산분석 (Two-way ANOVA) **
* 두개의 요인에 대한 3개 이상 집단의 모평균 차이 검정(독립변수 2개, 종속변수 1개)
* 그룹 간 변동(between-group variation)과 그룹 내 변동(within-group variation)을 이용해 분석
* 검정 : 정규성 검정, 등분산성 검정


